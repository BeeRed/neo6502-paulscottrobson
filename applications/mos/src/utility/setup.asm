; ************************************************************************************************
; ************************************************************************************************
;
;		Name:		setup.asm
;		Purpose:	Set everything up
;		Created:	25th May 2023
;		Reviewed: 	26th June 2023
;		Author:		Paul Robson (paul@robsons.org.uk)
;
; ************************************************************************************************
; ************************************************************************************************

		.section code

; ************************************************************************************************
;
;										Initialise
;
; ************************************************************************************************

OSInitialise:
		lda 	#48 						; 48x30 display
		sta 	OSXSize
		lda 	#30
		sta 	OSYSize
		stz 	OSCurrentMode 				; forces a display mode change
		lda 	#3 							; switch to mode 3.
		jsr 	OSSetDisplayMode
		jsr 	OSDClearScreen 				; clear the display
		jsr 	OSDKeyboardInitialise 		; reset the keyboard state.
		rts

; ************************************************************************************************
;
;									Get Screen Size -> XY
;
; ************************************************************************************************

OSSetDisplayMode:	
		phx 								; get current mode
		ldx 	OSCurrentMode
		sta 	$CF18  						; set new screen mode
		txa 								; return old
		plx
		rts

; ************************************************************************************************
;
;									Get Screen Size -> XY
;
; ************************************************************************************************

OSGetScreenSize:
		ldx 	OSXSize
		ldy 	OSYSize
		rts

; ************************************************************************************************
;
;									Get Cursor Position -> XY
;
; ************************************************************************************************

OSGetScreenPosition:
		ldx 	OSXPos
		ldy 	OSYPos
		rts
		
; ************************************************************************************************
;
;									Get break status
;
; ************************************************************************************************		

OSCheckBreak:
		lda 	OSEscapePressed
		rts
		
		.send code

; ************************************************************************************************
;
;									Changes and Updates
;
; ************************************************************************************************
;
;		Date			Notes
;		==== 			=====
;
; ************************************************************************************************

