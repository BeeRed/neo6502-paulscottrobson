; ************************************************************************************************
; ************************************************************************************************
;
;		Name:		emulator.asm
;		Purpose:	Emulator interface
;		Created:	1st July 2023
;		Reviewed: 	No
;		Author:		Paul Robson (paul@robsons.org.uk)
;
; ************************************************************************************************
; ************************************************************************************************

; ************************************************************************************************
;
;									Interface to Flash Hardware
;
; ************************************************************************************************

		.section code

; ************************************************************************************************
;
;										   Erase sector A
;
; ************************************************************************************************


FSHErase:
		sta 	$CF11 						; sector number.
		lda 	#0 							; erase command
		sta 	$CF10
		rts

; ************************************************************************************************
;
;						 Read Sector A, subpage X from iTemp0,y bytes (0 == 256)
;
; ************************************************************************************************

FSHRead:
		sty 	$CF15 						; byte count
		jsr 	FSHSetup 					; setup sector and address
		lda 	#1
		sta 	$CF10 						; read command.
		rts

; ************************************************************************************************
;
;							Write Sector A, subpage X from iTemp0
;
; ************************************************************************************************

FSHWrite:
		jsr 	FSHSetup 					; setup sector and address
		lda 	#2
		sta 	$CF10 						; write command.
		rts

; ************************************************************************************************
;
;										Common R/W setup
;
; ************************************************************************************************

FSHSetup:		
		sta 	$CF11 						; sector/subpage
		stx 	$CF12
		lda 	iTemp0
		sta 	$CF13 						; copy data
		lda 	iTemp0+1
		sta 	$CF14
		rts

		.send code
		
; ************************************************************************************************
;
;									Changes and Updates
;
; ************************************************************************************************
;
;		Date			Notes
;		==== 			=====
;
; ************************************************************************************************

